import { convertToHierarchy } from ".";

describe("convertToHierarchy 함수", () => {
  it("todo_item 리스트를 받고, 계층화해서 반환한다.", () => {
    expect(
      convertToHierarchy(
        [
          {
            id: "659ebf59-fd26-4de6-b63e-036d9a00d7f3",
            project_id: "c2ce67c9-8034-461e-8f52-13f2704d9dd5",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T05:01:47.184516+00:00",
            name: "업로드 성공한 파일 변경 시, 상태와 업로드 아이디 제거",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: "73e3380b-c2bd-4d29-85a7-9544cdefe8ad",
          },
          {
            id: "73e3380b-c2bd-4d29-85a7-9544cdefe8ad",
            project_id: "c2ce67c9-8034-461e-8f52-13f2704d9dd5",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T05:00:26.710947+00:00",
            name: "[] 업로드 파일 갱신 예외 처리",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: null,
          },
        ],
        "id",
        "upper_item_id"
      )
    ).toStrictEqual([
      {
        actual_ended: null,
        actual_started: null,
        assignees: null,
        children: [
          {
            actual_ended: null,
            actual_started: null,
            assignees: null,
            children: [],
            created_at: "2024-10-22T05:01:47.184516+00:00",
            id: "659ebf59-fd26-4de6-b63e-036d9a00d7f3",
            name: "업로드 성공한 파일 변경 시, 상태와 업로드 아이디 제거",
            notes: null,
            plan_ended: null,
            plan_started: null,
            progress: 0,
            project_id: "c2ce67c9-8034-461e-8f52-13f2704d9dd5",
            upper_item_id: "73e3380b-c2bd-4d29-85a7-9544cdefe8ad",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
          },
        ],
        created_at: "2024-10-22T05:00:26.710947+00:00",
        id: "73e3380b-c2bd-4d29-85a7-9544cdefe8ad",
        name: "[] 업로드 파일 갱신 예외 처리",
        notes: null,
        plan_ended: null,
        plan_started: null,
        progress: 0,
        project_id: "c2ce67c9-8034-461e-8f52-13f2704d9dd5",
        upper_item_id: null,
        user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
      },
    ]);
  });

  it("하위 항목에 진행도가 있는 경우, 상위 항목의 진행도를 계산한다.", () => {
    expect(
      convertToHierarchy(
        [
          {
            id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T06:50:01.99015+00:00",
            name: "프론트엔드",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: null,
          },
          {
            id: "797a6b6e-23b8-4e92-b86d-97fe61442292",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T06:50:18.631731+00:00",
            name: "[] 엔터로 업무 추가하는 경우, 두개가 생성되는 문제",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
          },
          {
            id: "17b5ed5e-9cdc-442c-b686-6abcb11f0a75",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T06:50:33.967591+00:00",
            name: "[] 하위항목 추가 시, 페이지 바로 업데이트 안되는 문제",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
          },
          {
            id: "e519c39d-08b9-4177-943b-956baab2bd49",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T06:50:51.469193+00:00",
            name: "[] 항목 삭제 시, 화면에 바로 적용되지 않는 문제",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
          },
          {
            id: "060314ac-a7d0-4dd0-a134-be4304c716b4",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T06:52:43.554741+00:00",
            name: "[] 완료나 진행중 처리 방법?",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
          },
          {
            id: "1273f80f-cde9-4b42-884d-f094f9beef7d",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T07:25:10.088472+00:00",
            name: "진척 완료 추가",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 100,
            assignees: null,
            notes: null,
            upper_item_id: "060314ac-a7d0-4dd0-a134-be4304c716b4",
          },
          {
            id: "ce99dc4b-5877-4486-b813-b7dec54cb47b",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T07:25:20.615945+00:00",
            name: "진행중 처리 추가",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 0,
            assignees: null,
            notes: null,
            upper_item_id: "060314ac-a7d0-4dd0-a134-be4304c716b4",
          },
          {
            id: "c3668854-07a9-4585-9ba4-6cd99817a098",
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
            created_at: "2024-10-22T08:09:55.168028+00:00",
            name: "[] 완료된 항목 보이지않는 옵션 추가",
            plan_started: null,
            plan_ended: null,
            actual_started: null,
            actual_ended: null,
            progress: 100,
            assignees: null,
            notes: null,
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
          },
        ],
        "id",
        "upper_item_id"
      )
    ).toStrictEqual([
      {
        actual_ended: null,
        actual_started: null,
        assignees: null,
        children: [
          {
            actual_ended: null,
            actual_started: null,
            assignees: null,
            children: [],
            created_at: "2024-10-22T06:50:18.631731+00:00",
            id: "797a6b6e-23b8-4e92-b86d-97fe61442292",
            name: "[] 엔터로 업무 추가하는 경우, 두개가 생성되는 문제",
            notes: null,
            plan_ended: null,
            plan_started: null,
            progress: 0,
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
          },
          {
            actual_ended: null,
            actual_started: null,
            assignees: null,
            children: [],
            created_at: "2024-10-22T06:50:33.967591+00:00",
            id: "17b5ed5e-9cdc-442c-b686-6abcb11f0a75",
            name: "[] 하위항목 추가 시, 페이지 바로 업데이트 안되는 문제",
            notes: null,
            plan_ended: null,
            plan_started: null,
            progress: 0,
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
          },
          {
            actual_ended: null,
            actual_started: null,
            assignees: null,
            children: [],
            created_at: "2024-10-22T06:50:51.469193+00:00",
            id: "e519c39d-08b9-4177-943b-956baab2bd49",
            name: "[] 항목 삭제 시, 화면에 바로 적용되지 않는 문제",
            notes: null,
            plan_ended: null,
            plan_started: null,
            progress: 0,
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
          },
          {
            actual_ended: null,
            actual_started: null,
            assignees: null,
            children: [
              {
                actual_ended: null,
                actual_started: null,
                assignees: null,
                children: [],
                created_at: "2024-10-22T07:25:10.088472+00:00",
                id: "1273f80f-cde9-4b42-884d-f094f9beef7d",
                name: "진척 완료 추가",
                notes: null,
                plan_ended: null,
                plan_started: null,
                progress: 100,
                project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
                upper_item_id: "060314ac-a7d0-4dd0-a134-be4304c716b4",
                user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
              },
              {
                actual_ended: null,
                actual_started: null,
                assignees: null,
                children: [],
                created_at: "2024-10-22T07:25:20.615945+00:00",
                id: "ce99dc4b-5877-4486-b813-b7dec54cb47b",
                name: "진행중 처리 추가",
                notes: null,
                plan_ended: null,
                plan_started: null,
                progress: 0,
                project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
                upper_item_id: "060314ac-a7d0-4dd0-a134-be4304c716b4",
                user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
              },
            ],
            created_at: "2024-10-22T06:52:43.554741+00:00",
            id: "060314ac-a7d0-4dd0-a134-be4304c716b4",
            name: "[] 완료나 진행중 처리 방법?",
            notes: null,
            plan_ended: null,
            plan_started: null,
            progress: 50,
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
          },
          {
            actual_ended: null,
            actual_started: null,
            assignees: null,
            children: [],
            created_at: "2024-10-22T08:09:55.168028+00:00",
            id: "c3668854-07a9-4585-9ba4-6cd99817a098",
            name: "[] 완료된 항목 보이지않는 옵션 추가",
            notes: null,
            plan_ended: null,
            plan_started: null,
            progress: 100,
            project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
            upper_item_id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
            user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
          },
        ],
        created_at: "2024-10-22T06:50:01.99015+00:00",
        id: "dd252b6a-1587-42f5-8f9a-9a948c01a676",
        name: "프론트엔드",
        notes: null,
        plan_ended: null,
        plan_started: null,
        progress: 30,
        project_id: "4ed49d6c-f8de-4c5f-a889-041b815c5b0d",
        upper_item_id: null,
        user_id: "38557b15-89d8-4493-8c48-938746cf6f2f",
      },
    ]);
  });
});
